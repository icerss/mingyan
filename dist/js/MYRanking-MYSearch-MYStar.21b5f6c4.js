/*!
 * ERSS SAYING
 * (c) 2020-2022 Xhemj
 * Build: 2022-4-5 11:43:40
 * Version: 3.1.1
 * ====
 * o(〃＾▽＾〃)o
 */
(window.webpackJsonp=window.webpackJsonp||[]).push([["MYRanking-MYSearch-MYStar"],{f561:function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var r,c,a=n("a8d5"),i=n("f026"),o=(n("e186"),n("89a8"),n("cfe5"),n("87d5"),n("865d"),n("cb0a"),n("b3d9"),n("1b2a")),u=n("d633"),f=n("9944"),s=n("2e83"),m=o.b.star_v3,b={getNum:function(t){if(Promise)return t||(t=Object(f.n)(".my--mingyan-name").innerText.trim()+"："+Object(f.n)(".my--mingyan-text").innerText.trim()),new Promise((function(e,n){fetch(m,Object(i.a)(Object(i.a)({},o.g),{},{body:JSON.stringify({event:"getnum",data:{MY_text:t,MY_token:Object(f.f)(),t:(new Date).getTime()}})})).then((function(t){return t.json()})).then((function(t){e(t)})).catch((function(t){n(t)}))}))},addStar:(c=Object(a.a)(regeneratorRuntime.mark((function t(e,n,r){var c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Promise){t.next=2;break}return t.abrupt("return");case 2:if(e||n||(e=Object(f.n)(".my--mingyan-name").innerText.trim()+"："+Object(f.n)(".my--mingyan-text").innerText.trim()),c={},n&&e&&(c={MY_text:e}),n&&!e&&(c={MY_ID:n}),!n&&e&&(c={MY_text:e}),t.prev=7,t.t0=r,t.t0){t.next=13;break}return t.next=12,Object(s.a)();case 12:t.t0=t.sent;case 13:return r=t.t0,t.abrupt("return",new Promise((function(t,e){fetch(m,Object(i.a)(Object(i.a)({},o.g),{},{body:JSON.stringify({event:"addstar",data:Object(i.a)(Object(i.a)({},c),{},{MY_token:Object(f.f)(),re_token:r,t:(new Date).getTime()})})})).then((function(t){return t.json()})).then((function(e){t(e),0===e.code&&Object(u.recordEvent)(u.recordEventId.addStarEvent)})).catch((function(t){e(t)}))})));case 17:t.prev=17,t.t1=t.catch(7),f.a.err("点赞失败："+t.t1);case 20:case"end":return t.stop()}}),t,null,[[7,17]])}))),function(t,e,n){return c.apply(this,arguments)}),removeStar:(r=Object(a.a)(regeneratorRuntime.mark((function t(e,n,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Promise){t.next=2;break}return t.abrupt("return");case 2:if(e||(e=Object(f.n)(".my--mingyan-name").innerText.trim()+"："+Object(f.n)(".my--mingyan-text").innerText.trim()),n=n||"",t.prev=4,t.t0=r,t.t0){t.next=10;break}return t.next=9,Object(s.a)();case 9:t.t0=t.sent;case 10:return r=t.t0,t.abrupt("return",new Promise((function(t,n){fetch(m,Object(i.a)(Object(i.a)({},o.g),{},{body:JSON.stringify({event:"removestar",data:{MY_text:e,MY_token:Object(f.f)(),re_token:r,t:(new Date).getTime()}})})).then((function(t){return t.json()})).then((function(e){t(e),0===e.code&&Object(u.recordEvent)(u.recordEventId.removeStarEvent)})).catch((function(t){n(t)}))})));case 14:t.prev=14,t.t1=t.catch(4),f.a.err("点赞失败："+t.t1);case 17:case"end":return t.stop()}}),t,null,[[4,14]])}))),function(t,e,n){return r.apply(this,arguments)}),getRanking:function(t){if(Promise)return new Promise((function(e,n){fetch(m,Object(i.a)(Object(i.a)({},o.g),{},{body:JSON.stringify({event:"ranking",data:{t:(new Date).getTime(),source:t}})})).then((function(t){return t.json()})).then((function(t){e(t),Object(u.recordEvent)(u.recordEventId.getCurrentRanking)})).catch((function(t){n(t)}))}))},getHistoryRanking:function(t){if(Promise)return new Promise((function(e,n){setTimeout((function(){n("请求超时")}),2e3),fetch("".concat(o.b.ranking_history,"?t=_").concat((new Date).getTime(),"&source=").concat(t)).then((function(t){return t.json()})).then((function(t){Object(f.k)(t),"请求成功"==t.msg&&(e(t.data),Object(u.recordEvent)(u.recordEventId.getHistoryRanking)),n(t.msg)}))}))},update:function(t,e){if(Promise){t||e||(t=Object(f.n)(".my--mingyan-name").innerText.trim()+"："+Object(f.n)(".my--mingyan-text").innerText.trim());var n={};return e&&t&&(n={MY_text:t}),e&&!t&&(n={MY_ID:e}),!e&&t&&(n={MY_text:t}),new Promise((function(t,e){fetch(m,Object(i.a)(Object(i.a)({},o.g),{},{body:JSON.stringify({event:"update",data:Object(i.a)(Object(i.a)({},n),{},{MY_token:Object(f.f)(),t:(new Date).getTime()})})})).then((function(t){return t.json()})).then((function(e){t(e)})).catch((function(t){e(t)}))}))}}}}}]);