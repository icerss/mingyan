(function(){let _mingyan=_mingyan||{};_mingyan.version="2021/02/11",_mingyan.config={___DEBUG__:!0,___date_version___:202102071808},"serviceWorker"in navigator&&window.addEventListener("load",(()=>{navigator.serviceWorker.register("./sw.js?t=202101281305")})),window.onload=function(){db("Page load time is "+(window.performance.timing.domContentLoadedEventEnd-window.performance.timing.navigationStart)+"ms")};var _hmt=_hmt||[];function gtag(){dataLayer.push(arguments)}!function(){let e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?0673dbbe4e6ea51a92a74e3ba2bc051b";let n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)}(),window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-RE30WVG95Q");let _={},_$=function(e){return document.querySelector(e)};!function(e){e.get=function(e,n,t){let a=new XMLHttpRequest;a.open("GET",e,!0),a.onload=function(){if(this.status>=200&&this.status<400){let e=this.response;t&&(e=JSON.parse(e)),n(e)}},a.onerror=function(){console.error("Error")},a.send()}}(_);let $main="#main",$search="#showall",$md="#md",$footer="footer",$myInfo="#info";window.localStorage||(window.localStorage={getItem:function(e){return e&&this.hasOwnProperty(e)?unescape(document.cookie.replace(new RegExp("(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"),"$1")):null},key:function(e){return unescape(document.cookie.replace(/\s*\=(?:.(?!;))*$/,"").split(/\s*\=(?:[^;](?!;))*[^;]?;\s*/)[e])},setItem:function(e,n){e&&(document.cookie=escape(e)+"="+escape(n)+"; expires=Tue, 19 Jan 2038 00:00:00 GMT; path=/",this.length=document.cookie.match(/\=/g).length)},length:0,removeItem:function(e){e&&this.hasOwnProperty(e)&&(document.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",this.length--)},hasOwnProperty:function(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)}},window.localStorage.length=(document.cookie.match(/\=/g)||window.localStorage).length);let hashName={"#/search":!0,"#/more":!0,"#/about":!0},picBaseUrl="https://s-sh-1943-pic1.oss.dogecdn.com";_mingyan.lazypic="./src/loading.svg";let ua=new Browser,footer=$($footer).html().replace("999+",mingyan.length),faceClickTime="";function loadJs(e){let n=document.createElement("script");n.src=e;let t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(n,t)}$($md).hide(),$($search).hide(),$($footer).html(footer),$("h1").fontFlex(30,50,70),$("h3").fontFlex(30,50,70);let dn=1,log=console.log;function db(e){if(_mingyan.config.___DEBUG__){let n="",t="";1!=e.toString().split("====").length&&"string"==typeof e&&(n="%c",t="color: red"),"string"==typeof e||"number"==typeof e?(log(`[ERSS名言]${(new Date).getHours()}:${(new Date).getMinutes()} #${dn} -> ${n}${e}`,t),dn++):(log(`[ERSS名言]${(new Date).getHours()}:${(new Date).getMinutes()} #${dn} -> ${n}`,t),log(e),dn++)}}function isSupportWebp(){try{return 0===document.createElement("canvas").toDataURL("image/webp",.5).indexOf("data:image/webp")}catch(e){return!1}}function qs(e){let n=location.href;n=n.replace("?","?&").split("&");let t="";for(let a=1;a<n.length;a++)0==n[a].indexOf(e+"=")&&(t=n[a].replace(e+"=",""));return t}function randomNumber(e,n){switch(arguments.length){case 1:return parseInt(Math.random()*e+1,10);case 2:return parseInt(Math.random()*(n-e+1)+e,10);default:return 0}}_mingyan.checkPic=function(e){let n=e.split("：")[0],t=null;2==e.split("：").length?(t=e.split("：")[1],db(t)):3==e.split("：").length&&(t=e.split("：")[1]+"："+e.split("：")[2],db(t));let a='onclick="_mingyan.onMingyanClick()"';if("解"==t||null!=mingyanPicUrl[t]){let e=null;return"解"==t?e=solvePicUrl[n]:null!=mingyanPicUrl[t]&&(e=mingyanPicUrl[t]),isSupportWebp()&&(e+="/webp"),_mingyan.checkPicForMobie(),lazyload(),`<div id="my_text" ${a}>${t}</div><div id="my_pic">\n                            <img src="${_mingyan.lazypic}" data-src="${picBaseUrl}${e}" data-pic-id=${t} class="mypic lazyload mdui-hoverable mdui-img-rounded fancybox" data-fancybox-group="ERSS_mingyan_pic"></img>\n                        </div>`}return lazyload(),`<div id="my_text" ${a}>${t}</div>`};let reloadTime=0;localStorage.getItem("reload-time")&&(localStorage.setItem("___mingyan_reload_time__",localStorage.getItem("reload-time")),localStorage.removeItem("reload-time")),localStorage.getItem("___mingyan_reload_time__")&&(reloadTime=localStorage.getItem("___mingyan_reload_time__")),_mingyan.addReloadTime=function(){reloadTime++,localStorage.setItem("___mingyan_reload_time__",reloadTime),db(reloadTime);let e;switch(reloadTime){case 10:e="点击 100 次有惊喜";break;case 100:e="点击 500 次有惊喜";break;case 500:e="点击 1000 次有惊喜，\n很大的惊喜哦！";break;case 1e3:e="点击 10000 次有惊喜，\n你都到这一步了，干嘛不看看后面的惊喜呢？";break;case 1e4:e="你好无聊啊……";break;default:e=""}e&&swal({title:"获得成就",text:e,icon:"success",button:"关闭",closeOnClickOutside:!1})},_mingyan.checkFaceClickTime=function(e){"xhemj"==e&&(faceClickTime+="1"),"BlackToy"==e&&(faceClickTime+="2"),"Oranjezelv"==e&&(faceClickTime+="3"),db(faceClickTime),-1!=faceClickTime.indexOf("1")&&-1!=faceClickTime.indexOf("2")&&-1!=faceClickTime.indexOf("3")&&(swal({title:"获得成就",text:"彩蛋还没做好~~",icon:"info",button:"关闭",closeOnClickOutside:!1}),faceClickTime="")},_mingyan.onMingyanClick=function(){if(-1!=$("#mingyan").text().indexOf("绿帽子")&&swal({title:"Fuck ♂ You ♂",text:"骚骚恪曾经说过：Fuck ♂ You ♂",icon:"",button:"关闭",closeOnClickOutside:!1}),-1!=$("#mingyan").text().indexOf("垃圾真好吃")&&swal({title:"获得成就",text:"最美垃圾人",icon:"success",button:"关闭",closeOnClickOutside:!1}),-1!=$("#mingyan").text().indexOf("来一起唱啊！！")){swal({title:"获得成就",text:"Shape OF You！",icon:"success",button:"关闭",closeOnClickOutside:!1});let e=new APlayer({container:document.getElementById("player"),fixed:!0,lrcType:3,audio:[{name:"Shape of You",artist:"Ed Sheeran",url:"https://s-sh-1943-pic1.oss.dogecdn.com/static%2Fmingyan-js-org%2FEd%20Sheeran%20-%20Shape%20of%20You.mp3",cover:"https://i.loli.net/2020/12/19/L1NY8U7nhRjyQMa.jpg",lrc:"https://s-sh-1943-pic1.oss.dogecdn.com/static%2Fmingyan-js-org%2FShape%20of%20You.lrc"}]});$(".aplayer .aplayer-lrc").css("transform","translateY(-55px)"),e.play()}},_mingyan.checkText=function(e){if(e=e.split("：")[1],null!=specialVerbList[e]){return specialVerbList[e]}return"曾经说过"},_mingyan.print=function(){_mingyan.showAll();let e=$("body").html();$("#searchbar").hide();let n=document.getElementById("showall").innerHTML.replace(/<a /g,"<span ").replace(/<\/a>/g,"</span>"),t=window.open("","","toolbar=no,scrollbars=yes,menubar=no");t.document.body.innerHTML="<title>名言 | ERSS</title>"+document.head.innerHTML+n+"</body></html>",t.print(),$("#searchbar").show(),t.close(),window.document.body.innerHTML=e,location.reload()},_mingyan.encodeMingyan=function(e,n){return db(e),db(n),md5("1"+md5(encodeURI(e+"||"+n+"ERSS MINGYAN (c) xhemj")))},_mingyan.decodeMingyan=function(e){for(let n=0;n<mingyan.length;n++){let t=mingyan[n].split("：")[0];db(t);let a=mingyan[n].split("：")[1];if(db(a),e==_mingyan.encodeMingyan(t,a))return db("encode:"+e),db(n),n;db("no")}},_mingyan.share=function(){let e=$("#name").text(),n=$("#mingyan").text().replace(/\s*/g,"");swal({title:"分享当前名言",text:"请手动复制下面的链接，把他发给别人吧",icon:"info",content:{element:"input",attributes:{placeholder:"加载出错了？刷新试试吧",value:location.protocol+"//"+location.host+"/"+_mingyan.encodeMingyan(e,n),type:"text"}}}),$(".swal-content__input").attr("value",location.protocol+"//"+location.host+"/"+_mingyan.encodeMingyan(e,n)),$(".swal-content__input").attr("onclick","this.select()"),$(".swal-content__input").select()},_mingyan.download=function(){let e=new Blob([mingyan.join("\n")],{type:"text/plain;charset=utf-8"});saveAs(e,"名言列表（"+_mingyan.version+"）")};let skipCheckHash=!1;_mingyan.show=function(e){initfancybox();try{if($($md).hide(),$($main).hide(),0==mingyan.length)return!1;{db("加载名言列表成功");let n=0;if(e?n=e:""!=qs("id")?n=qs("id"):""!=location.hash&&1!=hashName[location.hash]?(n=location.hash.replace("#",""),db("n="+n)):n=localStorage.getItem("___mingyan_id__")?localStorage.getItem("___mingyan_id__"):randomNumber(0,mingyan.length-1),1==hashName[location.hash])return;skipCheckHash=!0,location.hash="#"+n,skipCheckHash=!1,localStorage.setItem("___mingyan_id__",n);let t=mingyan[n].split("：")[0];db(t);let a=null;2==mingyan[n].split("：").length?(a=mingyan[n].split("：")[1],db(a)):3==mingyan[n].split("：").length&&(a=mingyan[n].split("：")[1]+"："+mingyan[n].split("：")[2],db(a)),db("已选取第"+n+"条名言："+a),_hmt.push(["_trackEvent","名言","查看","自动",t+"："+a]),$("p#info").html(`<div class="info-text">\n                    \x3c!-- 编号 --\x3e\n                    <a href="#${n}" class="label label-rounded label-warning">#${n}</a>&nbsp;\n                    \x3c!-- 分享\n                    <a href="javascript:;" onclick="_mingyan.share()" class="label label-rounded label-warning">\n                    <i class="mdui-icon material-icons" style="font-size: 15px;">&#xe80d;</i>分享</a> --\x3e\n                    \x3c!-- 点赞 --\x3e\n                    <a href="javascript:;" onclick="_mingyan.star()" class="label label-rounded label-warning">\n                    <i class="mdui-icon material-icons" style="font-size: 15px;">&#xe8dc;</i>点赞</a>\n                    </br>\n                    <a style="color:#9B4DC9" id="reload" href="#${randomNumber(0,mingyan.length-1)}" onclick="_mingyan.addReloadTime();_hmt.push(["_trackEvent", "名言", "刷新", "手动" , "点击查看更多名言"]);" >点击</a>查看更多名言</div>`),$("span#mingyan").html(_mingyan.checkPic(t+"："+a));let i=_mingyan.checkText(t+"："+a);$("span#name").text(t),$("span#verb").html(i),$($main).fadeIn(),-1!=$("#mingyan").text().indexOf("来一起唱啊！！")&&loadJs("https://cdn.jsdelivr.net/npm/aplayer@1.10.0/dist/APlayer.min.js");let o="名言 | "+a;document.title=o;let r=t+i+"："+a;$("meta[name='description']").attr("content",r),$("meta[property='og:description']").attr("content",r),$("meta[name='og:description']").attr("content",r),$("meta[property='og:title']").attr("content",o),$("meta[name='og:title']").attr("content",o),lazyload()}}catch(e){throw console.error("名言加载失败"),$("#mingyan").text("名言加载失败"),$($myInfo).html("错误信息：</br>"+e+'</br>建议：<a href="javascript:_mingyan.reload()">点我刷新页面</a>'),$($main).fadeIn(),$($myInfo).fadeIn(),new Error(e)}};let inputbar_width="";"Mobile"!=ua.device?inputbar_width="60%":(inputbar_width="auto",$($main).css("transform","translateY(30%)")),_mingyan.checkTextForMobie=function(){"Mobile"!=ua.device?$($main).css("transform","translateY(15%)"):($($main).css("transform","translateY(30%)"),$($md).css("transform","translateY(50px)"))},_mingyan.checkTextForMobie(),_mingyan.checkPicForMobie=function(){"Mobile"==ua.device?$($main).css("transform","translateY(15%)"):$($main).css("transform","translateY(10%)"),lazyload()},_mingyan.reload=function(){$("#reload").attr("href")?location.hash="#"+$("#reload").attr("href").split("#")[1]:location.hash="#"+randomNumber(0,mingyan.length-1)},_mingyan.hideElement=function(){$($md).hide(),$($search).hide(),$($main).fadeIn(),$($footer).html(footer)},_mingyan.hideMain=function(){$($main).hide()},_mingyan.showAll=function(){$($md).hide(),$($main).hide(),$("input#searchbar").val("");let e=`<input style="${inputbar_width}" onclick="this.select()" type="search" id="searchbar" placeholder="搜索……" results="5"></input>\n        </br></br><span class="e"></span>`;for(let n=0;n<mingyan.length;n++)e+=`<div><a style="color:black" id="showall_item" class="${n}" href="#${n}" onclick="_mingyan.hideElement()">${mingyan[n]}</a></div>`;e+="</br></br></br>",$($search).html(e),$($search).fadeIn(),$($footer).html(`当前名言数量：${mingyan.length}</br><a class="aline" href="javascript:;" onclick="_mingyan.clearHash()">返回</a>`),_mingyan.initLogo(),$("#searchbar").focus()},_mingyan.mdToHtml=function(e,n){$($md).hide(),$($main).hide(),$($search).hide(),$(e).html('<strong><div style="text-align: center" class="mdui-ripple"><style>h1{font-size:30px}</style><h1>加载中……</h1></div></strong></br></br></br></br>'),_.get(n,(function(n){marked.setOptions({breaks:!0});let t=marked(n);t=t.replace(/<a /g,'<a target="_blank" '),$(e).html("<strong>"+t+"</strong></br></br></br></br>"),$(e).fadeIn()})),$($footer).html("当前名言数量："+mingyan.length+'</br><a class="aline" href=javascript:; onclick="_mingyan.clearHash()">返回</a>'),_mingyan.initLogo(),$($md).fadeIn()},_mingyan.more=function(){_mingyan.mdToHtml($md,"./src/md/more.md?t="+_mingyan.config.___date_version___)},_mingyan.about=function(){_mingyan.mdToHtml($md,"./src/md/about.md?t="+_mingyan.config.___date_version___)},_mingyan.showAllMingyan=function(){$($md).hide(),$($main).hide(),$($search).hide();let e="";for(let n=0;n<mingyan.length;n++)e+=mingyan[n]+"</br>";e+="</br></br></br></br>",$($md).html(marked(e)),$($md).fadeIn()},_mingyan.tongji=function(){$($md).hide(),$($main).hide(),$($search).hide();let e="";for(let n=0;n<mingyan.length;n++){try{mingyan[n].split("：")[0],mingyan[n+1].split("：")[0]}catch(e){}db(a1+"-"+a2),a1==a2?e+=a1:e+=a2}let n="";n+=["数学老王："+e.match(/老王/g).length,"英语老俞："+e.match(/老俞/g).length,"数学潘哥："+e.match(/潘哥/g).length,"语文老朱："+e.match(/老朱/g).length,"物理刘老师："+e.match(/物理刘老师/g).length,"物理王老师："+e.match(/物理王老师/g).length,"地理吴老师："+e.match(/地理吴老师/g).length,"地理朱老师："+e.match(/地理朱老师/g).length,"政治王老师："+e.match(/政治王老师/g).length,"化学吴老师："+e.match(/化学吴老师/g).length,"历史李老师："+e.match(/历史李老师/g).length,"美术林老师："+e.match(/美术林老师/g).length,"体育吴老师："+e.match(/体育吴老师/g).length,"体育俞老师："+e.match(/体育俞老师/g).length,"生物吴老师："+e.match(/生物吴老师/g).length].join(" 句</br>")+" 句</br></br></br></br>",$($md).html(marked(n)),$($md).fadeIn()},_mingyan.search=function(){if($("#searchbar").is(":focus")||""!=qs("q"))if($("input#searchbar").val())switch($("input#searchbar").val()){case"::auto_reload":location.href="./?force_action=auto_reload";break;default:let now1=$("input#searchbar").val(),now2=$("input#searchbar").val();now1==now2&&($("a#showall_item").each((function(){if(-1!=$(this).text().indexOf($("input#searchbar").val())){let reg="/"+$("input#searchbar").val()+"/g";$(this).html($(this).text().replace(eval(reg),`<span class="label label-secondary">${$("input#searchbar").val()}</span>`)),$(this).show()}else $(this).hide()})),$(".e").hide())}else $("a#showall_item").show(),$("a#showall_item").each((function(){$(this).html($(this).html().replace('<span class="label label-secondary">',"")),$(this).html($(this).html().replace("</span>",""))}));null!=$($search)[0].innerText.match(/^\s*$/)?($(".e").text("无结果"),$(".e").show()):$("#searchbar").is(":focus")&&$(".e").hide()};let search=setInterval(_mingyan.search,100);qs("mail")&&(window.open("mailto:"+qs("mail").replace("---","@")),_mingyan.reload());let title="名言 | ERSS",titleTime;document.addEventListener("visibilitychange",(function(){document.hidden?(document.title="名言 | 来看名言呀！",clearTimeout(titleTime)):document.title=title}));const app=cloudbase.init({env:"xhemj-0gjckebwf7276129"}),auth=app.auth();async function login(){await auth.anonymousAuthProvider().signIn();const e=await auth.getLoginState();db("登陆成功"),db(e)}switch(login(),_mingyan.rankingApi={add:function(e,n){return new Promise((function(t,a){app.callFunction({name:"mingyan",data:{event:"add",name:e.toString(),ip:n,ua:navigator.userAgent.toString()||""}}).then((e=>{db("添加成功"),db(e),t(e)})).catch((function(e){a(e)}))}))},update:function(e,n){return new Promise((function(t,a){app.callFunction({name:"mingyan",data:{event:"update",id:e,data:{name:n}}}).then((e=>{db("获取成功"),db(e),t(e)})).catch((function(e){a(e)}))}))},getIp:function(){return new Promise((function(e,n){$.getJSON("https://ip.xhemj.now.sh/api/ip",(function(n){db("获取成功");let t={ip:n.ip};e(t)})).catch((function(e){n(e)}))}))},getNum:function(){return new Promise((function(e,n){app.callFunction({name:"mingyan",data:{event:"getnum"}}).then((n=>{db("获取成功"),db(n),e(n)})).catch((function(e){n(e)}))}))}},_mingyan.ranking=function(){if((new Date).getTime()<16094304e5)return;if(-1!=navigator.userAgent.toString().indexOf("bot")&&-1!=navigator.userAgent.toString().indexOf("spider"))return;if(localStorage.getItem("___mingyan_2021_ranking_data__"))return;if("skip_ranking"==qs("force_action")||"sr"==qs("do"))return void localStorage.setItem("___mingyan_2021_ranking_data__","__SKIP__");let e=null,n=null;_mingyan.rankingApi.getIp().then((function(e){return db(e.ip),n=e.ip,db("新用户"),localStorage.setItem("___mingyan_2021_ranking_data__",`__${n}__`),_mingyan.rankingApi.add("一位不知道名字的访客",n)})).then((function(t){return localStorage.setItem("___mingyan_2021_ranking_data__",`__${n}__`),e=t.result.res.id,_mingyan.rankingApi.getNum()})).then((function(e){let n=e.result.res1.data[0].num;return swal({title:`第${n}个人！！`,text:`恭喜你成为2021年第${n}个查看名言的人！！`,icon:"success",content:{element:"input",attributes:{placeholder:"写个名字记录一下你是谁吧！",type:"text"}},closeOnClickOutside:!1})})).then((function(n){if(n)return _mingyan.rankingApi.update(e,n);location.href="./"})).then((function(e){db(e),location.href="./"})).catch((function(e){console.error(e)}))},_mingyan.initLogo=function(){let e="png";isSupportWebp()&&(e="png/webp"),$($footer).append('<div id="logo"><div>'),$("#logo").html(`<img src="https://s-sh-1943-pic1.oss.dogecdn.com/2021/01/30/1PZ2sFjUd8EfLT6.${e}" alt="IYAMAYA工作室" title="IYAMAYA工作室"></img>`),"Mobile"!=ua.device?$("#logo").css({position:"absolute",bottom:"50px",right:"0px",width:"150px"}):$("#logo").css({position:"absolute",bottom:"50px",right:"0px",width:"120px"})},_mingyan.initLogo(),_mingyan.onHashChange=function(){if(initfancybox(),_mingyan.checkTextForMobie(),_mingyan.initLogo(),1==hashName[location.hash])switch(location.hash){case"#/about":location.pathname="/",_mingyan.hideElement(),_mingyan.hideMain(),_mingyan.about(),$("#logo").css("opacity",.5);break;case"#/search":location.pathname="/",_mingyan.hideElement(),_mingyan.hideMain(),_mingyan.showAll(),$("#logo").css("opacity",.5);break;case"#/more":location.pathname="/",_mingyan.hideElement(),_mingyan.hideMain(),_mingyan.more(),$("#logo").css("opacity",.5)}else location.hash.split("#").length>1&&!skipCheckHash&&_mingyan.show(location.hash.split("#")[1])},_mingyan.onHashChange(),window.addEventListener("hashchange",_mingyan.onHashChange),location.pathname){case"/about":location.hash="#/about";break;case"/search":location.hash="#/search";break;case"/more":location.hash="#/more";break;case"/index.html":case"/":switch($(document).ready((function(){_mingyan.show()})),"2020"!=qs("force_action")&&localStorage.getItem("___mingyan_2021_ranking_data__")||_mingyan.ranking(),qs("force_action")||qs("do")){case"clear_save":localStorage.removeItem("___mingyan_2021_ranking_data__");break;case"auto_reload":setInterval((function(){_mingyan.show()}),3e3)}break;default:if(32==location.pathname.split("/")[1].length){let e=_mingyan.decodeMingyan(location.pathname.split("/")[1]),n=new Number(e);$(document).ready((function(){_mingyan.show(n.toString())}))}else clearInterval(search),$(".app").load("./src/_404.html")}if(Headroom.cutsTheMustard){let e=document.getElementById("header"),n=new Headroom(e,{offset:300,tolerance:5});n.init()}function initfancybox(){setTimeout((()=>{$(".fancybox").fancybox({buttons:["zoom","share","slideShow","fullScreen","download","close"],lang:"zh-cn",i18n:{"zh-cn":{CLOSE:"关闭",NEXT:"下一张",PREV:"前一张",ERROR:"图片加载失败， <br/> 请稍后再试。",FULL_SCREEN:"全屏",THUMBS:"略缩图",DOWNLOAD:"下载",SHARE:"分享",ZOOM:"缩放"}}})}),500)}lazyload(),setInterval(lazyload,1e3),_mingyan.console=function(){let e="font-weight: 900;color: #9b4dca;font-size: 15px",n="font-weight: 900;color: #ffb700;font-size: 15px";db("欢迎！"),console.log("\n%c诗曰：                  %c________\n%c  王颢维尼熊猫，        %c| ERSS |\n%c  老杜金门菜刀，        %c| 名言 |\n%c  老王还在抠脚。        %c|______|\n%c  三天之内，\n  抠出一根面条。\n      ————— 天净沙·梗\n",e,n,e,n,e,n,e,n,e),_.get("https://api.github.com/repos/xhemj/mingyan/commits",(function(e){db(`版本：${e[0].sha.slice(0,7)}`)}),!0)},_mingyan.console(),_mingyan.goHome=_mingyan.clearHash=function(){skipCheckHash=!0,location.hash="",_mingyan.hideElement(),skipCheckHash=!1,_mingyan.show()},_mingyan.checkPage=function(){function e(e){return!$(e).is(":hidden")}function n(){let e=location.hash;if(hashName[e])switch(e){case"#/more":_mingyan.more();break;case"#/search":_mingyan.showAll();break;case"#/about":_mingyan.about()}else _mingyan.clearHash()}e($main)&&e($search)&&n(),e($main)&&e($md)&&n()},setInterval((()=>{_mingyan.checkPage()}),1e3),_mingyan.installPwa=function(){let e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/@pwabuilder/pwainstall@1.6.7/dist/pwa-install.js",e.type="module";let n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n);const t=document.getElementById("installComponent");return t.installbuttontext="安装",t.cancelbuttontext="取消",t.descriptionheader="描述",t.manifestpath="manifest.webmanifest",t.explainer="该应用可以安装在您的PC或移动设备上。这将使该Web应用程序外观和行为与任何其他已安装的应用程序相同。您将在应用程序列表中找到它，并将其固定到主屏幕，开始菜单或任务栏。此安装的Web应用程序还将能够与其他应用程序和您的操作系统安全地进行交互。",t.iosinstallinfotext="点击共享按钮，然后点击“添加到主屏幕”","PC"==ua.device&&$("#pwa-install").show(),t},$(document).ready((function(){_mingyan.installPwa()}));let starApiUrl="https://mingyan-star-api.xhemj.vercel.app/api/";_mingyan.starApi={isForceReadDb:!1,getNum:function(e){return e||(e=$("#name").text()+"："+$("#my_text").text()),new Promise((function(n,t){fetch(starApiUrl,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({event:"getnum",data:{my:e,id:md5(e),t:(new Date).getTime()}})}).then((e=>e.json())).then((e=>{db(e.data[0]),n(e.data[0])})).catch((function(e){t(e)}))}))},addStar:function(e){return e||(e=$("#name").text()+"："+$("#my_text").text()),new Promise((function(n,t){fetch(starApiUrl,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({event:"addstar",data:{my:e,id:md5(e),t:(new Date).getTime()}})}).then((e=>e.json())).then((e=>{db(e.data[0]),n(e.data[0])})).catch((function(e){t(e)}))}))},removeStar:function(e){return e||(e=$("#name").text()+"："+$("#my_text").text()),new Promise((function(n,t){fetch(starApiUrl,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({event:"removestar",data:{my:e,id:md5(e),t:(new Date).getTime()}})}).then((e=>e.json())).then((e=>{db(e.data[0]),n(e.data[0])})).catch((function(e){t(e)}))}))}},_mingyan.star=function(e){if(e||(e="getnum"),localStorage.getItem("___mingyan_star_data__")&&-1!=localStorage.getItem("___mingyan_star_data__").indexOf("，")){let e=localStorage.getItem("___mingyan_star_data__");e=e.split("，"),db(e);let n="";for(let t=0;t<e.length;t++)e[t]&&(n+="<"+e[t]+">");db(n),localStorage.setItem("___mingyan_star_data__",n)}db("event"+e);let n='\n        \x3c!-- 点赞 --\x3e\n        <i class="mdui-icon material-icons" id="star-logo" style="cursor: pointer;" onclick="_mingyan.star(\'addstar\')">&#xe8dc;</i>\n        <span id="star-num">\n        \x3c!-- 加载动画 --\x3e\n        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin: auto;background: none;shape-rendering: auto;position: relative;transform: translateY(10px);" width="15px" height="25px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">\n          <circle cx="50" cy="50" fill="none" stroke="rgba(0,0,0,.65)" stroke-width="10" r="35" stroke-dasharray="164.93361431346415 56.97787143782138">\n            <animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="0.75s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform>\n          </circle>\n        \x3c!-- https://loading.io/ --\x3e</svg>\n        </span>\n        ',t=!1;swal({title:$("#my_text").text(),text:"加载出错了？刷新试试？",icon:"",button:"关闭"}).then((function(){db("====位置：_mingyan.star->swal()->then()"),db("then"),_mingyan.starApi.isForceReadDb=!0,db("_mingyan.starApi.isForceReadDb："+_mingyan.starApi.isForceReadDb)})),$(".swal-text").html(n);let a=localStorage.getItem("___mingyan_star_data__")||"";db("alreadyStarData："+a),a||(t=!1),db("isAlreadyStar："+t),_mingyan.starApi.getNum().then((function(e){db("====位置：_mingyan.star->Api.getNum()");let n=e.id;return db("id："+n),-1!=a.indexOf("<"+n+">")&&(t=!0),db("isAlreadyStar："+t),t})).then((function(t){switch(db("====位置：_mingyan.star->Api.getNum()->then()"),e){case"addstar":db("====位置：switch(event)->'addstar'"),db("====位置：_addstar()"),db(t),t?(db("====位置：_addstar()->if(!isAlreadyStar)else"),db("点过赞了"),$("#star-logo").attr("onclick","_mingyan.star('removestar')"),db("_addstar()中的变换onclick2"),db("_addstar() else 中的Api.getNum"),_mingyan.starApi.getNum().then((function(e){db("====位置：_addstar()->if(!isAlreadyStar)else->Api.getNum()");let n=e.num;$("#star-num").html(n),$("#star-logo").css({color:"red"}),db("_addstar()中的变换颜色2")})).catch((function(e){console.error(e)}))):(db("====位置：_addstar()->if(!isAlreadyStar)"),$(".swal-text").html(n),db("_addstar()中的Api.addStar"),_mingyan.starApi.addStar().then((function(e){if(db("====位置：_addstar()->if(!isAlreadyStar)->Api.addStar()"),e){db("====位置：_addstar()->if(!isAlreadyStar)->Api.addStar()->if(addstar_res)"),db("点赞成功"),$("#star-logo").css({color:"red"}),db("_addstar()中的变换颜色");let n=e.num,t=localStorage.getItem("___mingyan_star_data__")||"";db(e),db(n+1),localStorage.setItem("___mingyan_star_data__",t+"<"+e.id+">"),$("#star-num").html(n+1),localStorage.removeItem("___mingyan_star__"),$("#star-logo").attr("onclick","_mingyan.star('removestar')"),db("_addstar()中的变换onclick")}})).catch((function(e){console.error(e)})));break;case"removestar":db("====位置：switch(event)->'removestar'"),db("====位置：_removestar()"),db("====位置：_removestar()->if(!isAlreadyStar)"),$(".swal-text").html(n),db("_removestar()中的Api.removeStar"),_mingyan.starApi.removeStar().then((function(e){if(db("====位置：_removestar()->if(!isAlreadyStar)->Api.removeStar()"),e){db("====位置：_removestar()->if(!isAlreadyStar)->Api.removeStar()->if(removestar_res)"),db("取消点赞成功"),$("#star-logo").css({color:"rgba(0,0,0,.65)"}),db("_removestar()中的变换颜色");let n=e.num,t=localStorage.getItem("___mingyan_star_data__")||"";db(e),db(n-1),localStorage.setItem("___mingyan_star_data__",t.replace("<"+e.id+">","")),$("#star-num").html(n-1),localStorage.removeItem("___mingyan_star__"),$("#star-logo").attr("onclick","_mingyan.star('addstar')"),db("_removestar()中的变换onclick")}})).catch((function(e){console.error(e)}));break;case"getnum":db("====位置：switch(event)->'getnum'"),function e(){db("====位置：_getnum()"),swal({title:$("#my_text").text(),text:"加载出错了？刷新试试？",icon:"",button:"关闭"}).then((function(){db("关闭弹窗"),_mingyan.starApi.isForceReadDb=!0,db("_mingyan.starApi.isForceReadDb："+_mingyan.starApi.isForceReadDb)})),$(".swal-text").html(n),!t||_mingyan.starApi.isForceReadDb?(db("====位置：_getnum()->if(!isAlreadyStar || _mingyan.starApi.isForceReadDb)"),_mingyan.starApi.getNum().then((function(e){db("====位置：_getnum()->if(!isAlreadyStar || _mingyan.starApi.isForceReadDb)->Api.getNum()"),$("#star-num").css({position:"relative",transform:"translateY(10px)"}),t||(db("====位置：_getnum()->if(!isAlreadyStar || _mingyan.starApi.isForceReadDb)->Api.getNum()->if(!isAlreadyStar)"),$("#star-logo").css({color:"rgba(0,0,0,.65)"}),db("_getnum()中的变换颜色")),$("#star-num").html(e.num)})).catch((function(e){console.error(e)})),_mingyan.starApi.isForceReadDb&&(db("====位置：_getnum()->if(!isAlreadyStar || _mingyan.starApi.isForceReadDb)->if(_mingyan.starApi.isForceReadDb)"),_mingyan.starApi.isForceReadDb=!1,e())):(db("====位置：_getnum()->if(!isAlreadyStar || _mingyan.starApi.isForceReadDb)else"),$("#star-logo").attr("onclick","_mingyan.star('removestar')"),db("_getnum()中的变换onclick"),_mingyan.starApi.getNum().then((function(e){db("====位置：_getnum()->if(!isAlreadyStar || _mingyan.starApi.isForceReadDb)else->Api.getNum()");let n=e.num;$("#star-num").html(n),$("#star-logo").css({color:"red"}),db("_getnum()中的变换颜色2")})).catch((function(e){console.error(e)})))}()}}))},window._mingyan=_mingyan,window.isSupportWebp=isSupportWebp,window.qs=qs,window.randomNumber=randomNumber,window.loadJs=loadJs,window.db=db,window.log=log,window._=_,window._$=_$})();